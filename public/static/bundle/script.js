(()=>{"use strict";var t=function(){function t(t,e,s){this.$Nav=t,this.state=e,this.props=s,this.$NavContainer=this.$Nav.querySelector(".page-nav-tab"),this.$NavAddButton=this.$Nav.querySelector(".add-tab-button"),this.$NavAddButton.addEventListener("click",this.props.addNewPage),this.setState(e)}return t.prototype.setState=function(t){this.state=t,this.render()},t.prototype.render=function(){var t=this,e=this.state,s=e.pageList,a=e.selectedPageId;this.$NavContainer.innerHTML="\n    ".concat(s.map((function(t,e){return"<div class='tab ".concat(a===t.id?"selected":"","'>\n        ").concat(t.page_name,'\n        <div class="tab-delete-button" id="').concat(t.id,'">ðŸ—‘</div>\n        </div>')})).join(""),"\n    "),this.$Nav.querySelectorAll(".tab").forEach((function(e){var s=e.childNodes[1];s.addEventListener("click",(function(){return t.props.deletePage(Number(s.id))})),e.addEventListener("click",(function(){return t.props.clickPageTab(Number(s.id))}))}))},t}();const e=t;var s="page_list",a="postit_page";function n(t,e){var s=JSON.stringify(e);localStorage.setItem(t,s)}function i(t){return JSON.parse(localStorage.getItem(t))}function o(t){document.addEventListener("mousemove",r);var e=t.target.parentElement,s=document.querySelectorAll(".postit"),a=e.classList;if(!a.contains("hold")){var n=t.clientX,i=t.clientY,o=e.getBoundingClientRect(),c=n-o.x,d=i-o.y;e.setAttribute("gap-x",String(c)),e.setAttribute("gap-y",String(d));var p=String((s.length>0?Math.max.apply(null,Array.from(s).map((function(t){return Number(t.getAttribute("priority"))}))):9999)+1);e.setAttribute("priority",p),e.style.zIndex=p,a.add("hold")}}function r(t){t.preventDefault();var e=document.querySelector(".postit.hold");if(e){var s=t.clientX,a=t.clientY,n=e.getAttribute("gap-x"),i=e.getAttribute("gap-y"),o=s-Number(n),r=a-Number(i);e.style.left=o+"px",e.style.top=r+"px"}}const c=function(){function t(t){var e=t.postit_id,s=t.contents,a=t.status,n=t.pos_X,i=t.pos_Y;this.postit_id=e||0,this.contents=s||"",this.status=a||"todo",this.pos_X=n,this.pos_Y=i}return t.prototype.setState=function(){this.render()},t.prototype.getState=function(){},t.prototype.render=function(){},t}();var d=function(){function t(t,e,s){this.postitList=[],this.postitLastId=1,this.$Page=t,this.state=e,this.props=s,this.addNewPostIt=this.addNewPostIt.bind(this),this.handleMouseUp=this.handleMouseUp.bind(this),this.$PostItContainer=this.$Page.querySelector(".postit-container"),this.$PostItBody=this.$Page.querySelector(".postit-body"),document.addEventListener("dragstart",(function(t){t.dataTransfer.setData("startX","".concat(t.clientX-22)),t.dataTransfer.setData("startY","".concat(t.clientY-74))})),document.addEventListener("dragover",(function(t){return t.preventDefault()})),document.addEventListener("drop",this.addNewPostIt);var a=this.state.selectedPageId;this.fetchData(a),this.setState(e)}return t.prototype.fetchData=function(t){var e=this,s=i("".concat(a,"_").concat(t));s||(n("".concat(a,"_").concat(t),[]),s=[]),this.postitList=s.map((function(t){return t.postit_id>e.postitLastId&&(e.postitLastId=t.postit_id),new c({postit_id:t.postit_id,status:t.status,contents:t.contents,pos_X:t.pos_X,pos_Y:t.pos_Y})}))},t.prototype.setState=function(t){this.state=t;var e=this.state.selectedPageId;this.fetchData(e),this.render()},t.prototype.addNewPostIt=function(t){var e=t.clientX,s=t.clientY,i=Number(t.dataTransfer.getData("startX")),o=Number(t.dataTransfer.getData("startY")),r=new c({postit_id:(this.postitLastId+=1,this.postitLastId),pos_X:e-i,pos_Y:s-o});this.postitLastId=this.postitList.push(r),n("".concat(a,"_").concat(this.state.selectedPageId),this.postitList),this.setState(this.state)},t.prototype.render=function(){this.$PostItBody.innerHTML="".concat(this.postitList.map((function(t,e){return"\n      <div class='postit' id=\"".concat(t.postit_id,'" style="left: ').concat(t.pos_X,"px; top: ").concat(t.pos_Y,'px;">\n        <div class="postit-top-area"></div>\n        <div class="postit-contents-area">ì•ˆë…•í•˜ì„¸ìš”</div>\n      </div>')})).join(""),"\n    "),this.drowPostit()},t.prototype.drowPostit=function(){var t=this;document.querySelectorAll(".postit").forEach((function(e,s){var a=e.getAttribute("priority");a||(a=s+1,e.setAttribute("priority",a)),e.style["z-index"]=a,e.addEventListener("mousedown",o),e.addEventListener("mouseup",t.handleMouseUp)}))},t.prototype.handleMouseUp=function(t){var e=t.target.parentElement,s=e.id,i=e.style,o=this.postitList.find((function(t){return t.postit_id===Number(s)}));o.pos_X=parseInt(i.left),o.pos_Y=parseInt(i.top),n("".concat(a,"_").concat(this.state.selectedPageId),this.postitList),document.removeEventListener("mousemove",r),t.preventDefault();var c=document.querySelector(".postit.hold");c&&(c.removeAttribute("gap-x"),c.removeAttribute("gap-y"),c.classList.remove("hold"))},t}();const p=d;var u=function(){return u=Object.assign||function(t){for(var e,s=1,a=arguments.length;s<a;s++)for(var n in e=arguments[s])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},u.apply(this,arguments)};const h=function(t,i){var o=this;this.addNewPage=function(){var t=o.state,e=t.pageList,a=t.maxPageId;e.push({id:(o.state=u(u({},o.state),{maxPageId:a+1}),o.state.maxPageId),page_name:"untitled",total_count:0,todo_count:0,ing_count:0,complete_count:0}),o.state.selectedPageId=o.state.maxPageId,n(s,e),o.NavComponent.setState(o.state),o.BodyComponent.setState(o.state)},this.deletePage=function(t){var e,i=o.state.pageList,r=i.findIndex((function(e){return e.id===t})),c=i.splice(r,1)[0];n(s,i),e="".concat(a,"_").concat(c.id),localStorage.removeItem(e),o.NavComponent.setState(o.state)},this.clickPageTab=function(t){var e=u(u({},o.state),{selectedPageId:t});o.NavComponent.setState(e),o.BodyComponent.setState(e)},this.$App=t,this.state=i,this.HeaderComponent=this.$App.querySelector(".postit-header"),this.NavComponent=new e(this.$App.querySelector(".postit-page-nav"),this.state,{addNewPage:this.addNewPage,deletePage:this.deletePage,clickPageTab:this.clickPageTab}),this.BodyComponent=new p(this.$App.querySelector(".postit-body-page"),this.state,{})};var l,g=document.querySelector(".app"),v={};(l=i(s))||n(s,l=[{id:1,page_name:"untitled",total_count:0,todo_count:0,ing_count:0,complete_count:0}]),v.pageList=l,v.lastPageId=l[l.length-1].id,v.selectedPageId=l[l.length-1].id,v.maxPageId=Math.max.apply(Math,l.map((function(t){return t.id}))),new h(g,v)})();