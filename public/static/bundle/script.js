(()=>{"use strict";var t=function(){function t(t,e,n){this.$Nav=t,this.state=e,this.props=n,this.$NavContainer=this.$Nav.querySelector(".page-nav-tab"),this.$NavAddButton=this.$Nav.querySelector(".add-tab-button"),this.$NavAddButton.addEventListener("click",this.props.addNewPage),this.setState(e)}return t.prototype.setState=function(t){this.state=t,this.render()},t.prototype.render=function(){var t=this,e=this.state,n=e.pageList,s=e.selectedPageId;this.$NavContainer.innerHTML="\n    ".concat(n.map((function(t,e){return"<div class='tab ".concat(s===t.id?"selected":"","'>\n        ").concat(t.page_name,'\n        <div class="tab-delete-button" id="').concat(t.id,'">🗑</div>\n        </div>')})).join(""),"\n    "),this.$Nav.querySelectorAll(".tab").forEach((function(e){var n=e.childNodes[1];n.addEventListener("click",(function(){return t.props.deletePage(Number(n.id))})),e.addEventListener("click",(function(){return t.props.clickPageTab(Number(n.id))}))}))},t}();const e=t;var n="page_list",s="postit_page";function o(t,e){var n=JSON.stringify(e);localStorage.setItem(t,n)}function i(t){return JSON.parse(localStorage.getItem(t))}function a(t){document.addEventListener("mousemove",r);var e=t.target.parentElement,n=document.querySelectorAll(".postit"),s=e.classList;if(!s.contains("hold")){var o=t.clientX,i=t.clientY,a=e.getBoundingClientRect(),c=o-a.x,p=i-a.y;e.setAttribute("gap-x",String(c)),e.setAttribute("gap-y",String(p));var d=String((n.length>0?Math.max.apply(null,Array.from(n).map((function(t){return Number(t.getAttribute("priority"))}))):9999)+1);e.setAttribute("priority",d),e.style.zIndex=d,s.add("hold")}}function r(t){t.preventDefault();var e=document.querySelector(".postit.hold");if(e){var n=t.clientX,s=t.clientY,o=e.getAttribute("gap-x"),i=e.getAttribute("gap-y"),a=n-Number(o),r=s-Number(i);e.style.left=a+"px",e.style.top=r+"px"}}function c(t){document.removeEventListener("mousemove",r),t.preventDefault();var e=document.querySelector(".postit.hold");e&&(e.removeAttribute("gap-x"),e.removeAttribute("gap-y"),e.classList.remove("hold"))}const p=function(){function t(t){var e=t.postit_id,n=t.contents,s=t.status,o=t.pos_X,i=t.pos_Y;this.postit_id=e||0,this.contents=n||"",this.status=s||"todo",this.pos_X=o,this.pos_Y=i}return t.prototype.setState=function(){this.render()},t.prototype.getState=function(){},t.prototype.render=function(){},t}();var d=function(){function t(t,e,n){this.postitList=[],this.$Page=t,this.state=e,this.props=n,this.onDragEnd=this.onDragEnd.bind(this),this.addNewPostIt=this.addNewPostIt.bind(this),this.$PostItContainer=this.$Page.querySelector(".postit-container"),this.$PostItContainer.addEventListener("dragend",this.addNewPostIt),this.$PostItBody=this.$Page.querySelector(".postit-body");var s=this.state.selectedPageId;this.fetchData(s),this.setState(e)}return t.prototype.fetchData=function(t){var e=i("".concat(s,"_").concat(t));e||(o("".concat(s,"_").concat(t),[]),e=[]),this.postitList=e.map((function(t){return new p({postit_id:t.postit_id,status:t.status,contents:t.contents,pos_X:t.pos_X,pos_Y:t.pos_Y})}))},t.prototype.setState=function(t){this.state=t;var e=this.state.selectedPageId;this.fetchData(e),this.render()},t.prototype.addNewPostIt=function(t){var e=t.clientX,n=t.clientY,i=new p({pos_X:e-90,pos_Y:n-90});this.postitList.push(i),o("".concat(s,"_").concat(this.state.selectedPageId),this.postitList),this.setState(this.state)},t.prototype.onDragEnd=function(t){var e=document.createElement("div");e.classList.add("postit"),e.innerHTML='\n      <div class="postit-top-area" ></div>\n      <div\n      class="postit-contents-area"\n      >안녕하세요</div>\n      ',this.$Page.appendChild(e);var n=t.clientX,s=t.clientY;e.style.left=n-90+"px",e.style.top=s-90+"px"},t.prototype.render=function(){this.$PostItBody.innerHTML="".concat(this.postitList.map((function(t,e){return"\n      <div class='postit' style=\"left: ".concat(t.pos_X,"px; top: ").concat(t.pos_Y,'px;">\n        <div class="postit-top-area"></div>\n        <div class="postit-contents-area">안녕하세요</div>\n      </div>')})).join(""),"\n    "),this.drowPostit(),document.addEventListener("mouseup",c)},t.prototype.drowPostit=function(){document.querySelectorAll(".postit").forEach((function(t,e){var n=t.getAttribute("priority");n||(n=e+1,t.setAttribute("priority",n)),t.style["z-index"]=n,t.addEventListener("mousedown",a)}))},t}();const u=d;var l=function(){return l=Object.assign||function(t){for(var e,n=1,s=arguments.length;n<s;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},l.apply(this,arguments)};const h=function(t,s){var i=this;this.addNewPage=function(){var t=i.state,e=t.pageList,s=t.maxPageId;e.push({id:(i.state=l(l({},i.state),{maxPageId:s+1}),i.state.maxPageId),page_name:"untitled",total_count:0,todo_count:0,ing_count:0,complete_count:0}),i.state.selectedPageId=i.state.maxPageId,o(n,e),i.NavComponent.setState(i.state)},this.deletePage=function(t){var e=i.state.pageList,s=e.findIndex((function(e){return e.id===t}));e.splice(s,1),o(n,e),i.NavComponent.setState(i.state)},this.clickPageTab=function(t){var e=l(l({},i.state),{selectedPageId:t});i.NavComponent.setState(e),i.BodyComponent.setState(e)},this.$App=t,this.state=s,this.HeaderComponent=this.$App.querySelector(".postit-header"),this.NavComponent=new e(this.$App.querySelector(".postit-page-nav"),this.state,{addNewPage:this.addNewPage,deletePage:this.deletePage,clickPageTab:this.clickPageTab}),this.BodyComponent=new u(this.$App.querySelector(".postit-body-page"),this.state,{})};localStorage.setItem("postit_page_1",JSON.stringify([{postit_id:1,contents:"안녕하세요 포스트1111이에요.",status:"ing",pos_X:100,pos_Y:200},{postit_id:2,contents:"안녕하세요 포스트2222이에요.",status:"todo",pos_X:300,pos_Y:200},{postit_id:3,contents:"안녕하세요 포스트3333이에요.",status:"complete",pos_X:500,pos_Y:200}]));var g,v=document.querySelector(".app"),f={};(g=i(n))||o(n,g=[{id:1,page_name:"untitled",total_count:0,todo_count:0,ing_count:0,complete_count:0}]),f.pageList=g,f.lastPageId=g[g.length-1].id,f.selectedPageId=g[g.length-1].id,f.maxPageId=Math.max.apply(Math,g.map((function(t){return t.id}))),new h(v,f)})();